extends layout


block content
    #main-wrapper.page-wrapper(data-layout='vertical' data-navbarbg='skin6' data-sidebartype='full' data-sidebar-position='fixed' data-header-position='fixed')
        // Sidebar Start
        aside.left-sidebar
            // Sidebar scroll
            div
                .brand-logo.d-flex.align-items-center.justify-content-between
                    a.text-nowrap.logo-img(href='/stech.manager/home')
                        img(src='/images/logos/logo.jpeg' width='180' alt='')
                    #sidebarCollapse.close-btn.d-xl-none.d-block.sidebartoggler.cursor-pointer
                        i.ti.ti-x.fs-8
                // Sidebar navigation
                nav.sidebar-nav.scroll-sidebar(data-simplebar='')
                    ul#sidebarnav
                         if terifyWith == "Admin"
                            li.nav-small-cap
                                i.ti.ti-dots.nav-small-cap-icon.fs-4
                                span.hide-menu Home
                            li.sidebar-item
                                a.sidebar-link(href='/stech.manager/home' aria-expanded='false')
                                    span
                                        i.ti.ti-layout-dashboard
                                    span.hide-menu Dashboard
                            li.nav-small-cap
                                i.ti.ti-dots.nav-small-cap-icon.fs-4
                                span.hide-menu Manager
                            li.sidebar-item
                                a.sidebar-link(href='/stech.manager/product' aria-expanded='false')
                                    span
                                        i.ti.ti-brand-producthunt
                                    span.hide-menu Product
                            li.sidebar-item
                                a.sidebar-link(href='/stech.manager/category' aria-expanded='false')
                                    span
                                        i.ti.ti-category
                                    span.hide-menu Category
                            li.sidebar-item
                                a.sidebar-link(href='/stech.manager/cart' aria-expanded='false')
                                    span
                                        i.ti.ti-shopping-cart
                                    span.hide-menu Cart
                            li.sidebar-item
                                a.sidebar-link(href='/stech.manager/chat' aria-expanded='false')
                                    span
                                        i.ti.ti-message-chatbot
                                    span.hide-menu Chat
                            li.sidebar-item
                                a.sidebar-link(href='/stech.manager/notification' aria-expanded='false')
                                    span
                                        i.ti.ti-notification
                                    span.hide-menu Notification
                            li.sidebar-item
                                a.sidebar-link(href='/stech.manager/customer' aria-expanded='false')
                                    span
                                        i.ti.ti-cards
                                    span.hide-menu Customer
                            li.sidebar-item
                                a.sidebar-link(href='/stech.manager/order' aria-expanded='false')
                                    span
                                        i.ti.ti-file-description
                                    span.hide-menu Order
                            li.sidebar-item
                                a.sidebar-link(href='/stech.manager/voucher' aria-expanded='false')
                                    span
                                        i.ti.ti-file-description
                                    span.hide-menu Voucher
                            li.sidebar-item
                                a.sidebar-link(href='/stech.manager/banner' aria-expanded='false')
                                    span
                                        i.ti.ti-file-import
                                    span.hide-menu Banner
                            li.nav-small-cap
                                i.ti.ti-dots.nav-small-cap-icon.fs-4
                                span.hide-menu AUTH
                            li.sidebar-item
                                a.sidebar-link(href='/stech.manager/type_login' aria-expanded='false')
                                    span
                                        i.ti.ti-login
                                    span.hide-menu Login
                            li.sidebar-item
                                a.sidebar-link(href='/stech.manager/register' aria-expanded='false')
                                    span
                                        i.ti.ti-user-plus
                                    span.hide-menu Register
                         else
                            li.sidebar-item
                                a.sidebar-link(href='/stech.manager/product' aria-expanded='false')
                                    span
                                        i.ti.ti-brand-producthunt
                                    span.hide-menu Product
                            li.sidebar-item
                                a.sidebar-link(href='/stech.manager/cart' aria-expanded='false')
                                    span
                                        i.ti.ti-shopping-cart
                                    span.hide-menu Cart
                            li.sidebar-item
                                a.sidebar-link(href='/stech.manager/order' aria-expanded='false')
                                    span
                                        i.ti.ti-file-description
                                    span.hide-menu Order
                            li.nav-small-cap
                                i.ti.ti-dots.nav-small-cap-icon.fs-4
                                span.hide-menu AUTH
                            li.sidebar-item
                                a.sidebar-link(href='/stech.manager/type_login' aria-expanded='false')
                                    span
                                        i.ti.ti-login
                                    span.hide-menu Login
                // End Sidebar navigation
            // End Sidebar scroll
        // Sidebar End
        // Main wrapper
        .body-wrapper
            // Header Start
            header.app-header
                nav.navbar.navbar-expand-lg.navbar-light
                    ul.navbar-nav
                        li.nav-item.d-block.d-xl-none
                            a#headerCollapse.nav-link.sidebartoggler.nav-icon-hover(href='javascript:void(0)')
                                i.ti.ti-menu-2
                    #navbarNav.navbar-collapse.justify-content-end.px-0
                        ul.navbar-nav.flex-row.ms-auto.align-items-center.justify-content-end
                            if terifyWith == "Admin"
                                a#CreateProduct.btn.btn-outline-primary(href='/stech.manager/product_action') Create Product
                            li.nav-item.dropdown
                                a#drop2.nav-link.nav-icon-hover(href='javascript:void(0)' data-bs-toggle='dropdown' aria-expanded='false')
                                    img.rounded-circle(src='/images/logos/logo.jpeg' alt='' width='35' height='35')
                                .dropdown-menu.dropdown-menu-end.dropdown-menu-animate-up(aria-labelledby='drop2')
                                    .message-body
                                        a.d-flex.align-items-center.gap-2.dropdown-item(href='/stech.manager/profile')
                                            i.ti.ti-user.fs-6
                                            p.mb-0.fs-3 My Profile
                                        a.d-flex.align-items-center.gap-2.dropdown-item(href='')
                                            i.ti.ti-mail.fs-6
                                            p.mb-0.fs-3 My Account
                                        a.d-flex.align-items-center.gap-2.dropdown-item(href='javascript:void(0)')
                                            i.ti.ti-list-check.fs-6
                                            p.mb-0.fs-3 My Task
                                        a#logout.btn.btn-outline-primary.mx-3.mt-2.d-block(href='/stech.manager/login') Logout
            .container-fluid
                form#searchForm(action='javascript:void(0)', onsubmit='return false;')
                    .input-group.m-3
                        input#searchInput.form-control(type='text', name='query', placeholder='Enter your search query...' oninput='searchProducts()')
                        button#searchButton.btn.btn-outline-secondary(type='button') Search
                .row
                    //- Item Category
                    each product in products
                        .col-sm-6.col-xl-3
                            .card.overflow-hidden.rounded-2
                                .position-relative
                                    a(href='#')
                                        img.card-img-top.rounded-0(src=product.img_cover alt='...')
                                .card-body.pt-3.p-4
                                    h6.fw-semibold.fs-4= product.name
                                    h6.fw-semibold.fs-4 #{Intl.NumberFormat('vi-VN').format(product.price)} VNƒê
                                    ul.navbar-nav.flex-row.ms-auto.align-items-center.justify-content-end
                                        li.nav-item.dropdown
                                            //- .nav-link
                                            a#drop2.nav-icon-hover(href='#' data-bs-toggle='dropdown' aria-expanded='false')
                                                button.btn.btn-secondary(type='button') Tu·ª≥ ch·ªçn
                                                .dropdown-menu.dropdown-menu-end.dropdown-menu-animate-up(aria-labelledby='drop2')
                                                    .message-body
                                                        a#OpenAddCart.d-flex.align-items-center.gap-2.dropdown-item.AddCartPro(href='' data-bs-toggle='modal' data-id=product data-bs-target="#AddCartModal")
                                                            i.ti.ti-shopping-cart.fs-6
                                                            p.mb-0.fs-3 Th√™m v√†o gi·ªè h√†ng
                                                        a#Detail.d-flex.align-items-center.gap-2.dropdown-item.DetailPro(aria-expanded='false' data-id=product._id)
                                                            i.ti.ti-list-details.fs-6
                                                            p.mb-0.fs-3 Chi ti·∫øt s·∫£n ph·∫©m
                                                        if terifyWith == "Admin"
                                                            if product.status == "stocking"
                                                                a.d-flex.align-items-center.gap-2.dropdown-item.DeletePro( class="openModalDeleteProduct" href='' data-id=product._id data-bs-toggle='modal' data-bs-target="#DelProModal")
                                                                    i.ti.ti-trash.fs-6
                                                                    p.mb-0.fs-3 ·∫®n s·∫£n ph·∫©m
                                                            else
                                                                a.d-flex.align-items-center.gap-2.dropdown-item.DeletePro( class="openModalUnDeleteProduct" href='' data-id=product._id data-bs-toggle='modal' data-bs-target="#unDelProModal")
                                                                    i.ti.ti-trash.fs-6
                                                                    p.mb-0.fs-3 H·ªßy ·∫©n
                                                            a.d-flex.align-items-center.gap-2.dropdown-item( data-bs-toggle='modal' data-id=product._id class = 'OpenUpdateProduct')
                                                                i.ti.ti-edit.fs-6
                                                                p.mb-0.fs-3 S·ª≠a s·∫£n ph·∫©m
                //- End Pagination
                .py-6.px-6.text-center
                    p.mb-0.fs-4 Design and Developed by&nbsp;
                        a.pe-1.text-primary.text-decoration-underline(href='https://trinh-dien-203.onrender.com' target='_blank') STECH

            #AddCartModal.modal.fade
                .modal-dialog
                    .modal-content
                        .modal-header
                            h5.modal-title Th√™m v√†o gi·ªè h√†ng
                            button.btn-close(type='button', data-bs-dismiss='modal', aria-label='Close')
                        .modal-body
                            form(method='post' action='/stech.manager/AddCart')
                                .mb-3
                                    img#Addimg.rounded-circle.p-1(src='', alt='', width='110')
                                .mb-3
                                    input#Addtitle.form-control(placeholder='Nh·∫≠p t√™n s·∫£n ph·∫©m', type='text', aria-describedby='textHelp' value=products.name readonly)

                                div#colorAdd
                                    .mb-3
                                        th color
                                        input#colorDropdown.form-control(name='color' readonly)
                                div#ramAdd
                                    .mb-3
                                        th ram
                                        input#ramDropdown.form-control.mb-3(name='ram' readonly)
                                div#romAdd
                                    .mb-3
                                        th rom
                                        input#romDropdown.form-control.mb-3(name='rom' readonly)
                                .mb-3
                                    th quantity
                                    input#Addquantity.form-control.text-center(class='quantity-checkbox' style='width: 90px;' type='number' name='quantity' min='1' value='1')
                                .mb-3.d-none
                                    th productId
                                    input#productId.form-control.text-center(type='text' name='productId' readonly)
                                .mb-3
                                    h4.mt-3 T·ªïng ti·ªÅn:
                                        span#total.ms-2
                                button.btn.btn-dark(type='button', data-bs-dismiss='modal') H·ªßy
                                button.ms-3#ConfirmAddCartPro1.btn.btn-outline-dark-light(type='submit' data-bs-dismiss='modal') Th√™m v√†o gi·ªè h√†ng

            #DeleteProductModal.modal(tabindex='-1')
                .modal-dialog
                    .modal-content
                        .modal-header
                            h5.modal-title ·∫®n Product!
                        .modal-body
                            p.ms-4 B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ·∫©n?
                            .modal-body
                                form(action="/stech.manager/deleteProduct" method="post")
                                    .mb-3.d-none
                                        input#idProductDelete.form-control(name='productId', type='text', aria-describedby='textHelp')
                                    button.btn.btn-dark(type='button' data-bs-dismiss='modal') Quay l·∫°i
                                    button.ms-3.btn.btn-danger(type='submit') ƒê·ªìng √Ω
            #unDeleteProductModal.modal(tabindex='-1')
                .modal-dialog
                    .modal-content
                        .modal-header
                            h5.modal-title H·ªßy ·∫©n Product!
                        .modal-body
                            p.ms-4 B·∫°n c√≥ ch·∫Øc ch·∫Øn h·ªßy ·∫©n?
                            .modal-body
                                form(action="/stech.manager/undeleteProduct" method="post")
                                    .mb-3.d-none
                                        input#idProductUnDelete.form-control(name='productId', type='text', aria-describedby='textHelp')
                                    button.btn.btn-dark(type='button' data-bs-dismiss='modal') Quay l·∫°i
                                    button.ms-3.btn.btn-danger(type='submit') ƒê·ªìng √Ω
    script(src="/js/product.js")
    script.
        function removeDiacritics(str) {
            return str.normalize("NFD").replace(/[\u0300-\u036f]/g, "");
        }
        function searchProducts() {
            const query = removeDiacritics(document.getElementById('searchInput').value.toLowerCase());
            const candidateRows = document.querySelectorAll('.col-sm-6.col-xl-3');

            candidateRows.forEach(function (row) {
                const productName = removeDiacritics(row.querySelector('.card-body.pt-3.p-4 h6').innerText.toLowerCase());

                // N·∫øu kh√¥ng c√≥ th√¥ng tin t√¨m ki·∫øm ho·∫∑c t√¨m th·∫•y k·∫øt qu·∫£, hi·ªÉn th·ªã l·∫°i d√≤ng
                if (!query || productName.includes(query)) {
                    row.style.display = 'table-row';
                } else {
                    row.style.display = 'none';
                }
            });
        }